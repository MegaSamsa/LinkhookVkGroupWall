```
   __ _       _    _                 _           _    
  / /(_)_ __ | | _| |__   ___   ___ | | __/\   /\ | __
 / / | | '_ \| |/ / '_ \ / _ \ / _ \| |/ /\ \ / / |/ /
/ /__| | | | |   <| | | | (_) | (_) |   <  \ V /|   < 
\____/_|_| |_|_|\_\_| |_|\___/ \___/|_|\_\  \_/ |_|\_\
LinkhookVk [Version 1.2]
```
## Описание проекта
Скрипт осуществляет сбор ссылок на новые посты в заданной группе ВК. Собранные ссылки записываются в Excel-таблицу. Помимо ссылки вносится и дата публикации. Предусмотрена работа с закреплёнными постами (скрипт пропускает закреплённый пост)
## Навигация
1. [Описание проекта](#Описание-проекта)
2. [Навигация](#Навигация)
3. [Структура проекта](#Структура-проекта)
4. [Файл конфигурации](#Файл-конфигурации)
5. [Заполнение конфига](#Заполнение-конфига)
6. [Технологии](#Технологии)
7. [Установка](#Установка)
## Структура проекта
```
LinkhookVkGroupWall
 ┣ .gitignore
 ┣ config.json
 ┣ init.py
 ┣ Ссылки.xlsx
 ┣ main.py
 ┣ readme.md
 ┗ run.bat
```
## Файл конфигурации

| Имя переменной | Тип данных | Описание                 |
| -------------- | ---------- | ------------------------ |
| group_id       | str        | ID ВК группы             |
| access_token   | str        | токен доступа            |
| version        | str        | версия API               |
| check_interval | int        | интервал проверок (сек.) |
| file_path      | str        | путь к Excel-файлу       |
| file_name      | str        | имя Excel-файла          |
## Заполнение конфига
В корневой директории проекта создайте json-файл с названием config.json. Внесите в него параметры:
```json
{
	"group_id": "",
	"access_token": "",
	"version": "",
	"check_interval": ,
	"file_path": "",
	"file_name": ""
}
```
Теперь нужно заполнить эти параметры:
- [group_id](#group_id)
- [access_token](#access_token)
- [version](#version)
- [check_interval](#check_interval)
- [file_path](#file_path)
- [file_name](#file_name)

>[!Warning]
>После всех изменений не забудьте сохранить config.json
#### group_id
Для получения `group_id` нужно перейти в требуемую группу ВК и скопировать ID. Если у группы есть маска ID, можно скопировать ссылку на любой пост в группе и оттуда достать ID.
Например, имеем группу с ссылкой `https://vk.com/vk`, где ID скрыт под маской `vk`. Откроем любой пост и скопируем ссылку: `https://vk.com/wall-22822305_1579266`. Архитектура такой ссылки такова `домен/место - ID группы _ номер поста`. Отсюда и берём наш ID.
Скопируйте ID требуемой группы и перейдите в **config.json**. Теперь задайте значение group_id:
```json
{
	"group_id": "0123456789"
}
```
#### access_token
Для получения access-токена нужно создать мини-приложение ВК типа "Мини-приложение" или "Плагин для сообществ". Затем перейдите в раздел "Разработка" -> "Ключи доступа". Скопируйте сгенерированный **сервисный** ключ ([официальная документация](https://dev.vk.com/ru/method/wall.getById)).
Теперь перейдите в **config.json** и задайте значение для access_token:
```json
{
	"group_id": "0123456789",
	"access_token": "qwe123rty456uio789"
}
```
#### version
```json
{
	"group_id": "0123456789",
	"access_token": "qwe123rty456uio789",
	"version": "5.131"
}
```
#### check_interval
Здесь нужно указать интервал проверок (в секундах):
```json
{
	"group_id": "0123456789",
	"access_token": "qwe123rty456uio789",
	"version": "5.131",
	"check_interval": 60
}
```
#### file_path
Скопируйте путь в который будет сохраняться Excel-файл. Например, это будет рабочий стол.
>[!Warning]
>Необходимо замените слеши на обратные и в конце строки добавить такой же слеш

```json
{
	"group_id": "0123456789",
	"access_token": "qwe123rty456uio789",
	"version": "5.131",
	"check_interval": 60,
	"file_path": "C:/Users/Admin/Desktop/"
}
```
#### file_name
Задайте любое название для Excel-файла, указав в конце `.xlsx`
```json
{
	"group_id": "0123456789",
	"access_token": "qwe123rty456uio789",
	"version": "5.131",
	"check_interval": 60,
	"file_path": "C:/Users/Admin/Desktop/",
	"file_name": "Ссылки.xlsx"
}
```
## Технологии
При разработке использовался язык Python версии 3.10.5
Требуемые библиотеки:
```
requests
time
json
os
sys
pandas
```
## Установка
Установите Python версии не ниже 3.10.5. При установке в ОС Windows **необходимо отметить флажок «Добавить Python в PATH»**.
Далее перейдите в CMD и введите команды:
```
python -m pip install -U pandas
python -m pip install -U openpyxl
```
Теперь [настройте файл конфигурации](#Заполнение%20config.json). После настройки конфига можно запустить `run.bat` из директории проекта.